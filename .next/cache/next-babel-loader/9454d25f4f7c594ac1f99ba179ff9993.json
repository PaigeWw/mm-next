{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nvar _jsxFileName = \"/Users/paige/Desktop/workspace/mm-next/components/tables/self-order-table.js\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from \"react\";\nimport { Flex, Text, Box, Button, Row, Column } from \"rebass\";\nimport Table, { TableLine, ProductInfo } from \"./base-table\";\nimport ShowStyle from \"../show-style\";\nimport InputNumber from \"../number-input\";\nimport request from \"../../utils/request\";\nexport default (function (props) {\n  var _useState = useState([]),\n      orderList = _useState[0],\n      setOrderList = _useState[1];\n\n  var _useState2 = useState([]),\n      orderDetailList = _useState2[0],\n      setOrderDetailList = _useState2[1];\n\n  var _useState3 = useState([]),\n      selectList = _useState3[0],\n      setSelectList = _useState3[1];\n\n  var getOrderList =\n  /*#__PURE__*/\n  function () {\n    var _ref = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var res, data;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return request(\"/order/getMyList\", {\n                isSend: 1\n              });\n\n            case 2:\n              res = _context.sent;\n\n              if (res) {\n                _context.next = 5;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 5:\n              setOrderDetailList(res);\n              data = res.map(function (order) {\n                var orderData = order.orderData;\n                var threeViewsList = [];\n                var quantity = 0;\n                var price = 0;\n                orderData.map(function (item) {\n                  var threeViews = item.favorite.styleAndColor.map(function (x) {\n                    return {\n                      POSITIVE: x.front\n                    };\n                  });\n                  quantity += item.total;\n                  price += item.totalPrice;\n                  threeViewsList.push(threeViews);\n                });\n                return {\n                  date: order.updateTime,\n                  id: order._id\n                };\n              });\n              setOrderList(data);\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function getOrderList() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    getOrderList();\n  }, []);\n\n  var handleSelect = function handleSelect(index, item) {\n    var pos = selectList.findIndex(function (x) {\n      return x.index === index;\n    });\n\n    if (pos < 0) {\n      selectList.push(_objectSpread({\n        index: index\n      }, item));\n    } else {\n      selectList.splice(pos, 1);\n    }\n\n    setSelectList([].concat(selectList));\n  };\n\n  var handleSendOrder =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              console.log(selectList);\n              _context2.next = 3;\n              return request(\"/order/send\", {\n                list: selectList.map(function (s) {\n                  return s.id;\n                })\n              }, \"post\");\n\n            case 3:\n              res = _context2.sent;\n\n              if (res) {\n                props.nextStep();\n              }\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleSendOrder() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(Flex, {\n    flexDirection: \"column\",\n    justifyContent: \"space-between\",\n    sx: {\n      cursor: \"pointer\",\n      height: \"100%\",\n      background: \"#FFF0E5\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63\n    },\n    __self: this\n  }, __jsx(Flex, {\n    sx: {\n      padding: \"0 18px 18px 18px\"\n    },\n    alignItems: \"stretch\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72\n    },\n    __self: this\n  }, __jsx(Table, {\n    sx: {\n      margin: \"0\",\n      marginRight: \"1px\",\n      width: \"100%\"\n    },\n    titles: [{\n      name: \"00\",\n      width: \"2/22\",\n      isHide: true\n    }, {\n      name: \"ORDER NUMBER\",\n      width: \"2/22\"\n    }, {\n      name: \"ORDER DATE\",\n      width: \"4/22\"\n    }, {\n      name: \"CLIENT'S NAME\",\n      width: \"1/22\"\n    }, {\n      name: \"ACTION\",\n      width: \"2/22\"\n    }],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  }, orderList.map(function (order, index) {\n    return __jsx(TableLine, {\n      haveDel: true,\n      onDel: function onDel() {\n        handleDel(index, {});\n      },\n      Bigger: true // onEdit={() => {\n      // \t// setEditIndex(index)\n      // \t// setShowEditBox(true)\n      // }}\n      ,\n      key: \"\".concat(index, \"-my-order\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, __jsx(Text, {\n      lineHeight: \"0.6rem\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, index), __jsx(Text, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, order.id), __jsx(Text, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, order.date), __jsx(Text, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, \"?\"));\n  }))));\n});","map":{"version":3,"sources":["/Users/paige/Desktop/workspace/mm-next/components/tables/self-order-table.js"],"names":["React","useState","useEffect","Flex","Text","Box","Button","Row","Column","Table","TableLine","ProductInfo","ShowStyle","InputNumber","request","props","orderList","setOrderList","orderDetailList","setOrderDetailList","selectList","setSelectList","getOrderList","isSend","res","data","map","order","orderData","threeViewsList","quantity","price","item","threeViews","favorite","styleAndColor","x","POSITIVE","front","total","totalPrice","push","date","updateTime","id","_id","handleSelect","index","pos","findIndex","splice","concat","handleSendOrder","console","log","list","s","nextStep","cursor","height","background","padding","margin","marginRight","width","name","isHide","handleDel"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\"\nimport { Flex, Text, Box, Button, Row, Column } from \"rebass\"\nimport Table, { TableLine, ProductInfo } from \"./base-table\"\nimport ShowStyle from \"../show-style\"\nimport InputNumber from \"../number-input\"\nimport request from \"../../utils/request\"\n\nexport default props => {\n\tconst [orderList, setOrderList] = useState([])\n\tconst [orderDetailList, setOrderDetailList] = useState([])\n\tconst [selectList, setSelectList] = useState([])\n\tconst getOrderList = async () => {\n\t\tconst res = await request(\"/order/getMyList\", { isSend: 1 })\n\t\t// console.log(\"----res----\", res)\n\t\tif (!res) return\n\t\tsetOrderDetailList(res)\n\t\tconst data = res.map(order => {\n\t\t\tlet orderData = order.orderData\n\t\t\tlet threeViewsList = []\n\t\t\tlet quantity = 0\n\t\t\tlet price = 0\n\t\t\torderData.map(item => {\n\t\t\t\tlet threeViews = item.favorite.styleAndColor.map(x => {\n\t\t\t\t\treturn { POSITIVE: x.front }\n\t\t\t\t})\n\t\t\t\tquantity += item.total\n\t\t\t\tprice += item.totalPrice\n\t\t\t\tthreeViewsList.push(threeViews)\n\t\t\t})\n\n\t\t\treturn {\n\t\t\t\tdate: order.updateTime,\n\t\t\t\tid: order._id\n\t\t\t}\n\t\t})\n\t\tsetOrderList(data)\n\t}\n\tuseEffect(() => {\n\t\tgetOrderList()\n\t}, [])\n\tconst handleSelect = (index, item) => {\n\t\tconst pos = selectList.findIndex(x => x.index === index)\n\t\tif (pos < 0) {\n\t\t\tselectList.push({ index, ...item })\n\t\t} else {\n\t\t\tselectList.splice(pos, 1)\n\t\t}\n\t\tsetSelectList([].concat(selectList))\n\t}\n\tconst handleSendOrder = async () => {\n\t\tconsole.log(selectList)\n\n\t\tconst res = await request(\n\t\t\t\"/order/send\",\n\t\t\t{ list: selectList.map(s => s.id) },\n\t\t\t\"post\"\n\t\t)\n\t\tif (res) {\n\t\t\tprops.nextStep()\n\t\t}\n\t}\n\treturn (\n\t\t<Flex\n\t\t\tflexDirection=\"column\"\n\t\t\tjustifyContent=\"space-between\"\n\t\t\tsx={{\n\t\t\t\tcursor: \"pointer\",\n\t\t\t\theight: \"100%\",\n\t\t\t\tbackground: \"#FFF0E5\"\n\t\t\t}}\n\t\t>\n\t\t\t<Flex sx={{ padding: \"0 18px 18px 18px\" }} alignItems=\"stretch\">\n\t\t\t\t<Table\n\t\t\t\t\tsx={{ margin: \"0\", marginRight: \"1px\", width: \"100%\" }}\n\t\t\t\t\ttitles={[\n\t\t\t\t\t\t{ name: \"00\", width: \"2/22\", isHide: true },\n\t\t\t\t\t\t{ name: \"ORDER NUMBER\", width: \"2/22\" },\n\t\t\t\t\t\t{ name: \"ORDER DATE\", width: \"4/22\" },\n\t\t\t\t\t\t{ name: \"CLIENT'S NAME\", width: \"1/22\" },\n\t\t\t\t\t\t{ name: \"ACTION\", width: \"2/22\" }\n\t\t\t\t\t]}\n\t\t\t\t>\n\t\t\t\t\t{orderList.map((order, index) => (\n\t\t\t\t\t\t<TableLine\n\t\t\t\t\t\t\thaveDel\n\t\t\t\t\t\t\tonDel={() => {\n\t\t\t\t\t\t\t\thandleDel(index, {})\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tBigger\n\t\t\t\t\t\t\t// onEdit={() => {\n\t\t\t\t\t\t\t// \t// setEditIndex(index)\n\t\t\t\t\t\t\t// \t// setShowEditBox(true)\n\t\t\t\t\t\t\t// }}\n\t\t\t\t\t\t\tkey={`${index}-my-order`}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Text lineHeight=\"0.6rem\">{index}</Text>\n\t\t\t\t\t\t\t{/* <Text>MRMISS 20191118</Text> */}\n\t\t\t\t\t\t\t<Text>{order.id}</Text>\n\t\t\t\t\t\t\t<Text>{order.date}</Text>\n\t\t\t\t\t\t\t<Text>?</Text>\n\t\t\t\t\t\t</TableLine>\n\t\t\t\t\t))}\n\t\t\t\t</Table>\n\t\t\t</Flex>\n\t\t</Flex>\n\t)\n}\n"]},"metadata":{},"sourceType":"module"}