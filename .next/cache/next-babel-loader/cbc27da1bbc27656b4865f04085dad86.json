{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState } from \"react\";\nimport { Flex, Text, Box, Button, Row, Column } from \"rebass\";\nimport Table, { TableLine } from \"./base-table\";\nimport ShowStyle from \"../show-style\";\nimport request from \"../../utils/request\";\nexport default (function (props) {\n  var _useState = useState([]),\n      orderList = _useState[0],\n      setOrderList = _useState[1];\n\n  var _useState2 = useState([]),\n      orderDetailList = _useState2[0],\n      setOrderDetailList = _useState2[1];\n\n  var _useState3 = useState([]),\n      selectList = _useState3[0],\n      setSelectList = _useState3[1];\n\n  var getOrderList =\n  /*#__PURE__*/\n  function () {\n    var _ref = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var res, data;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return request(\"/order/getMyList\", {\n                isSend: 0\n              });\n\n            case 2:\n              res = _context.sent;\n\n              if (res) {\n                _context.next = 5;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 5:\n              setOrderDetailList(res);\n              data = res.map(function (order) {\n                var orderData = order.orderData;\n                var threeViewsList = [];\n                var quantity = 0;\n                var price = 0;\n                orderData.map(function (item) {\n                  var threeViews = item.favorite.styleAndColor.map(function (x) {\n                    return {\n                      POSITIVE: x.front\n                    };\n                  });\n                  quantity += item.total;\n                  price += item.totalPrice;\n                  threeViewsList.push(threeViews);\n                });\n                return {\n                  quantity: quantity,\n                  price: price,\n                  threeViewsList: threeViewsList,\n                  date: order.updateTime,\n                  id: order._id\n                };\n              });\n              setOrderList(data);\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function getOrderList() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    getOrderList();\n  }, []);\n\n  var handleSelect = function handleSelect(index, item) {\n    var pos = selectList.findIndex(function (x) {\n      return x.index === index;\n    });\n\n    if (pos < 0) {\n      selectList.push(_objectSpread({\n        index: index\n      }, item));\n    } else {\n      selectList.splice(pos, 1);\n    }\n\n    setSelectList([].concat(selectList));\n  };\n\n  var handleSendOrder =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              console.log(selectList);\n              _context2.next = 3;\n              return request(\"/order/send\", {\n                list: selectList.map(function (s) {\n                  return s.id;\n                })\n              }, \"post\");\n\n            case 3:\n              res = _context2.sent;\n\n              if (res) {\n                props.nextStep();\n              }\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleSendOrder() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(Flex, {\n    flexDirection: \"column\",\n    justifyContent: \"space-between\",\n    alignItems: \"stretch\",\n    height: \"100%\",\n    sx: {\n      cursor: \"pointer\",\n      background: \"#FFF0E5\"\n    }\n  }, __jsx(Table, {\n    titles: [{\n      name: \"00\",\n      width: \"2/22\",\n      isHide: true\n    }, {\n      name: \"DATE\",\n      width: \"2/22\"\n    }, {\n      name: \"STYLE PREVIEW\",\n      width: \"2/22\"\n    }, {\n      name: \"QUANTITY\",\n      width: \"4/22\"\n    }, {\n      name: \"PRICE\",\n      width: \"1/22\"\n    }, {\n      name: \"ACTION\",\n      width: \"5/22\"\n    }]\n  }, orderList.map(function (order, index) {\n    return __jsx(TableLine, {\n      key: \"order-\".concat(index),\n      isSelect: selectList.findIndex(function (x) {\n        return index === x.index;\n      }) >= 0,\n      haveSelect: true,\n      onSelect: function onSelect() {\n        handleSelect(index, order);\n      },\n      haveDel: true,\n      onDel: function onDel() {\n        handleDel(index, {});\n      },\n      haveEdit: true,\n      onEdit: function onEdit() {// setEditIndex(index)\n        // setShowEditBox(true)\n      }\n    }, __jsx(Text, {\n      style: {\n        position: \"absolute\"\n      }\n    }, index + 1), __jsx(Text, null, order.date), __jsx(Flex, {\n      justifyContent: \"center\"\n    }, order.threeViewsList.map(function (item, index1) {\n      return __jsx(ShowStyle, {\n        padding: \"10px\",\n        key: \"order-\".concat(index, \"-\").concat(index1),\n        imgWidth: \"0.95rem\",\n        mode: \"POSITIVE\",\n        threeViews: item,\n        border: \"none\",\n        hideInfo: true\n      });\n    })), __jsx(Text, {\n      textAlign: \"center\"\n    }, order.quantity), __jsx(Text, {\n      textAlign: \"center\"\n    }, order.price));\n  })), __jsx(Flex, null, __jsx(Button, {\n    variant: \"primary\",\n    height: \"1.5rem\",\n    width: \"19.2rem\",\n    bg: \"#000\",\n    color: \"#fff\",\n    padding: \"0\",\n    sx: {\n      borderRadius: 0,\n      fontSize: \"0.27rem\",\n      cursor: \"pointer\"\n    },\n    onClick: handleSendOrder\n  }, \"SEND ORDERS\")));\n});","map":null,"metadata":{},"sourceType":"module"}