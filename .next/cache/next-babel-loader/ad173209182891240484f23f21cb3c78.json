{"ast":null,"code":"import _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport axios from \"axios\";\nimport { baseUrl } from \"./helper\";\nvar instance = axios.create({\n  // baseURL: \"http://8.209.64.159:3006/api/\",\n  baseURL: baseUrl + \"/api/\",\n  // withCredentials: true,\n  timeout: 10000,\n  headers: {\n    \"content-type\": \"application/x-www-form-urlencoded\"\n  }\n});\ninstance.interceptors.request.use(function (config) {\n  /**\n   * 请求时从本地读取token，并设置headers\n   */\n  var token = localStorage.token;\n  config.headers.Authorization = \"Bearer \".concat(token);\n\n  if (config.method === \"post\") {\n    config.headers[\"content-type\"] = \"application/json\";\n  }\n\n  console.log(config);\n  return config;\n}, function (error) {\n  return _Promise.reject(error);\n});\ninstance.interceptors.response.use(function (response) {\n  console.log(\"response\", response);\n\n  if (response.config.url.includes(\"user/login\")) {\n    if (response.data && response.data.data) {\n      localStorage.token = response.data.data.token;\n    }\n  }\n\n  if (!response.data.success) {//请求出错\n  }\n\n  return response.data;\n}, function (error) {\n  var response = error.response || {};\n  console.log(\"错误： \", response);\n  handleErrorStatus(response.status, response.message);\n  return _Promise.reject(response);\n}); // 错误提示\n\nvar handleErrorStatus = function handleErrorStatus(status, message) {\n  console.log(status, message);\n};\n\nexport default (function () {\n  var url = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n  var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var method = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"get\";\n  var origin = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n  var api = arguments.length > 4 ? arguments[4] : undefined;\n  // var postData = new FormData()\n  // for (var prop in data) {\n  // \tpostData.append(prop, data[prop])\n  // }\n  var options = method.toLowerCase() === \"get\" ? {\n    params: data\n  } : data;\n  return instance[method](url, options).then(function (res) {\n    return res.data;\n  })[\"catch\"](function (err) {\n    // handleErrorStatus(code, err.message)\n    console.log(\"err: \", err);\n    return false;\n  });\n});","map":{"version":3,"sources":["/Users/paige/Desktop/workspace/mm-next/utils/request.js"],"names":["axios","baseUrl","instance","create","baseURL","timeout","headers","interceptors","request","use","config","token","localStorage","Authorization","method","console","log","error","reject","response","url","includes","data","success","handleErrorStatus","status","message","origin","api","options","toLowerCase","params","then","res","err"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,OAAT,QAAwB,UAAxB;AACA,IAAMC,QAAQ,GAAGF,KAAK,CAACG,MAAN,CAAa;AAC7B;AACAC,EAAAA,OAAO,EAAEH,OAAO,GAAG,OAFU;AAG7B;AACAI,EAAAA,OAAO,EAAE,KAJoB;AAK7BC,EAAAA,OAAO,EAAE;AACR,oBAAgB;AADR;AALoB,CAAb,CAAjB;AAUAJ,QAAQ,CAACK,YAAT,CAAsBC,OAAtB,CAA8BC,GAA9B,CACC,UAAAC,MAAM,EAAI;AACT;;;AAGA,MAAMC,KAAK,GAAGC,YAAY,CAACD,KAA3B;AACAD,EAAAA,MAAM,CAACJ,OAAP,CAAeO,aAAf,oBAAyCF,KAAzC;;AACA,MAAID,MAAM,CAACI,MAAP,KAAkB,MAAtB,EAA8B;AAC7BJ,IAAAA,MAAM,CAACJ,OAAP,CAAe,cAAf,IAAiC,kBAAjC;AACA;;AACDS,EAAAA,OAAO,CAACC,GAAR,CAAYN,MAAZ;AACA,SAAOA,MAAP;AACA,CAZF,EAaC,UAAAO,KAAK;AAAA,SAAI,SAAQC,MAAR,CAAeD,KAAf,CAAJ;AAAA,CAbN;AAgBAf,QAAQ,CAACK,YAAT,CAAsBY,QAAtB,CAA+BV,GAA/B,CACC,UAAAU,QAAQ,EAAI;AACXJ,EAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBG,QAAxB;;AACA,MAAIA,QAAQ,CAACT,MAAT,CAAgBU,GAAhB,CAAoBC,QAApB,CAA6B,YAA7B,CAAJ,EAAgD;AAC/C,QAAIF,QAAQ,CAACG,IAAT,IAAiBH,QAAQ,CAACG,IAAT,CAAcA,IAAnC,EAAyC;AACxCV,MAAAA,YAAY,CAACD,KAAb,GAAqBQ,QAAQ,CAACG,IAAT,CAAcA,IAAd,CAAmBX,KAAxC;AACA;AACD;;AACD,MAAI,CAACQ,QAAQ,CAACG,IAAT,CAAcC,OAAnB,EAA4B,CAC3B;AACA;;AACD,SAAOJ,QAAQ,CAACG,IAAhB;AACA,CAZF,EAaC,UAAAL,KAAK,EAAI;AACR,MAAME,QAAQ,GAAGF,KAAK,CAACE,QAAN,IAAkB,EAAnC;AACAJ,EAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBG,QAApB;AACAK,EAAAA,iBAAiB,CAACL,QAAQ,CAACM,MAAV,EAAkBN,QAAQ,CAACO,OAA3B,CAAjB;AACA,SAAO,SAAQR,MAAR,CAAeC,QAAf,CAAP;AACA,CAlBF,E,CAqBA;;AACA,IAAMK,iBAAiB,GAAG,SAApBA,iBAAoB,CAACC,MAAD,EAASC,OAAT,EAAqB;AAC9CX,EAAAA,OAAO,CAACC,GAAR,CAAYS,MAAZ,EAAoBC,OAApB;AACA,CAFD;;AAIA,gBAAe,YAA8D;AAAA,MAA7DN,GAA6D,uEAAvD,EAAuD;AAAA,MAAnDE,IAAmD,uEAA5C,EAA4C;AAAA,MAAxCR,MAAwC,uEAA/B,KAA+B;AAAA,MAAxBa,MAAwB,uEAAf,KAAe;AAAA,MAARC,GAAQ;AAC5E;AACA;AACA;AACA;AACA,MAAMC,OAAO,GAAGf,MAAM,CAACgB,WAAP,OAAyB,KAAzB,GAAiC;AAAEC,IAAAA,MAAM,EAAET;AAAV,GAAjC,GAAoDA,IAApE;AAEA,SAAOpB,QAAQ,CAACY,MAAD,CAAR,CAAiBM,GAAjB,EAAsBS,OAAtB,EACLG,IADK,CACA,UAAAC,GAAG,EAAI;AACZ,WAAOA,GAAG,CAACX,IAAX;AACA,GAHK,WAIC,UAAAY,GAAG,EAAI;AACb;AACAnB,IAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBkB,GAArB;AACA,WAAO,KAAP;AACA,GARK,CAAP;AASA,CAhBD","sourcesContent":["import axios from \"axios\"\nimport { baseUrl } from \"./helper\"\nconst instance = axios.create({\n\t// baseURL: \"http://8.209.64.159:3006/api/\",\n\tbaseURL: baseUrl + \"/api/\",\n\t// withCredentials: true,\n\ttimeout: 10000,\n\theaders: {\n\t\t\"content-type\": \"application/x-www-form-urlencoded\"\n\t}\n})\n\ninstance.interceptors.request.use(\n\tconfig => {\n\t\t/**\n\t\t * 请求时从本地读取token，并设置headers\n\t\t */\n\t\tconst token = localStorage.token\n\t\tconfig.headers.Authorization = `Bearer ${token}`\n\t\tif (config.method === \"post\") {\n\t\t\tconfig.headers[\"content-type\"] = \"application/json\"\n\t\t}\n\t\tconsole.log(config)\n\t\treturn config\n\t},\n\terror => Promise.reject(error)\n)\n\ninstance.interceptors.response.use(\n\tresponse => {\n\t\tconsole.log(\"response\", response)\n\t\tif (response.config.url.includes(\"user/login\")) {\n\t\t\tif (response.data && response.data.data) {\n\t\t\t\tlocalStorage.token = response.data.data.token\n\t\t\t}\n\t\t}\n\t\tif (!response.data.success) {\n\t\t\t//请求出错\n\t\t}\n\t\treturn response.data\n\t},\n\terror => {\n\t\tconst response = error.response || {}\n\t\tconsole.log(\"错误： \", response)\n\t\thandleErrorStatus(response.status, response.message)\n\t\treturn Promise.reject(response)\n\t}\n)\n\n// 错误提示\nconst handleErrorStatus = (status, message) => {\n\tconsole.log(status, message)\n}\n\nexport default (url = \"\", data = {}, method = \"get\", origin = false, api) => {\n\t// var postData = new FormData()\n\t// for (var prop in data) {\n\t// \tpostData.append(prop, data[prop])\n\t// }\n\tconst options = method.toLowerCase() === \"get\" ? { params: data } : data\n\n\treturn instance[method](url, options)\n\t\t.then(res => {\n\t\t\treturn res.data\n\t\t})\n\t\t.catch(err => {\n\t\t\t// handleErrorStatus(code, err.message)\n\t\t\tconsole.log(\"err: \", err)\n\t\t\treturn false\n\t\t})\n}\n"]},"metadata":{},"sourceType":"module"}