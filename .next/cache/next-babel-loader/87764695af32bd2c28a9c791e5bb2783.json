{"ast":null,"code":"import _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from \"react\";\nimport { Flex, Text, Box, Image, Button } from \"rebass\";\nimport Head from \"../components/nav\";\nimport EditBox from \"../components/made-edit-box\";\nimport BigBox from \"../components/made-big-box\";\nimport StyleItem from \"../components/made-style-item\";\nimport { getPageQuery } from \"../utils/helper\";\nimport Router from \"next/router\";\nimport request from \"../utils/request.js\"; // import SelectAssignTool from \"../components/select-assign-tool\"\n\nexport default (function () {\n  var _jsx, _jsx2;\n\n  var _useState = useState([]),\n      styleDetails = _useState[0],\n      setStyleDetails = _useState[1];\n\n  var _useState2 = useState(false),\n      showBigBox = _useState2[0],\n      setShowBigBox = _useState2[1];\n\n  var _useState3 = useState(false),\n      showEditBox = _useState3[0],\n      setShowEditBox = _useState3[1];\n\n  var _useState4 = useState(0),\n      curItemIndex = _useState4[0],\n      setCurItemIndex = _useState4[1];\n\n  var _useState5 = useState([[], [], [], [], [], []]),\n      styleInitData = _useState5[0],\n      setStyleInitData = _useState5[1];\n\n  var _useState6 = useState([]),\n      collectList = _useState6[0],\n      setCollectList = _useState6[1];\n\n  useEffect(function () {\n    var getStyleDetails =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var query, reqList, req, i, req1, _i;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                query = getPageQuery();\n                console.log(query);\n                reqList = [];\n                _context.next = 5;\n                return request(\"style/detail\", {\n                  _id: query.id\n                }, \"get\");\n\n              case 5:\n                req = _context.sent;\n                reqList.push(req);\n\n                for (i = 0; i < 6; i++) {\n                  styleInitData[i].push({\n                    imgUrl: req.imgUrl,\n                    value: false\n                  });\n                }\n\n                if (!query.id1) {\n                  _context.next = 14;\n                  break;\n                }\n\n                _context.next = 11;\n                return request(\"style/detail\", {\n                  _id: query.id1\n                }, \"get\");\n\n              case 11:\n                req1 = _context.sent;\n                reqList.push(req1);\n\n                for (_i = 0; _i < 6; _i++) {\n                  styleInitData[_i].push({\n                    imgUrl: req1.imgUrl,\n                    value: false\n                  });\n                }\n\n              case 14:\n                setStyleInitData([].concat(styleInitData));\n                setStyleDetails(reqList);\n\n              case 16:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function getStyleDetails() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    getStyleDetails();\n  }, []);\n\n  var handleConfirmMade = function handleConfirmMade(colorIds, imgUrls) {\n    console.log(colorIds, imgUrls);\n    if (!colorIds[0]) return;\n    styleInitData[curItemIndex] = [{\n      colorId: colorIds[0],\n      imgUrl: imgUrls[0]\n    }];\n\n    if (styleDetails.length > 1) {\n      if (!colorIds[1]) return;\n      styleInitData[curItemIndex].push({\n        colorId: colorIds[1],\n        imgUrl: imgUrls[1]\n      });\n    }\n\n    setStyleInitData([].concat(styleInitData));\n  };\n\n  var handleAddFavorite =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2(index) {\n      var params, res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (styleInitData[index][0].colorId) {\n                _context2.next = 2;\n                break;\n              }\n\n              return _context2.abrupt(\"return\");\n\n            case 2:\n              console.log(styleInitData[index][0]);\n              params = [{\n                styleId: styleDetails[0]._id,\n                colorId: styleInitData[index][0].colorId,\n                front: styleInitData[index][0].imgUrl\n              }];\n              collectList.push(index);\n              setCollectList([].concat(collectList));\n\n              if (!(styleDetails.length > 1)) {\n                _context2.next = 10;\n                break;\n              }\n\n              if (styleInitData[index][1].colorId) {\n                _context2.next = 9;\n                break;\n              }\n\n              return _context2.abrupt(\"return\");\n\n            case 9:\n              params.push({\n                styleId: styleDetails[1]._id,\n                colorId: styleInitData[index][1].colorId,\n                front: styleInitData[index][1].imgUrl\n              });\n\n            case 10:\n              _context2.next = 12;\n              return request(\"/user/addFavorite\", {\n                styleAndColor: params\n              }, \"post\");\n\n            case 12:\n              res = _context2.sent;\n              // setStyleDetails([].concat(styleDetails))\n              console.log(res);\n\n            case 14:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleAddFavorite(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(React.Fragment, null, __jsx(Flex, {\n    flexDirection: \"column\"\n  }, __jsx(Head, null), __jsx(Flex, {\n    flexDirection: \"column\"\n  }, __jsx(Flex, {\n    justifyContent: \"space-around\",\n    alignItems: \"center\",\n    fontSize: \"0.23px\",\n    bg: \"#000\",\n    color: \"#fff\",\n    width: \"19.2rem\",\n    height: \"1.12rem\"\n  }, __jsx(Text, null, \"TOPS\"), __jsx(Text, null, \"BOTTOMS\")), __jsx(Flex, {\n    flexWrap: \"wrap\"\n  }, styleInitData.map(function (style, index) {\n    return __jsx(StyleItem, {\n      key: \"\".concat(index, \"-style\"),\n      styleList: style,\n      index: index,\n      collected: collectList.indexOf(index) >= 0,\n      openBigBox: function openBigBox() {\n        setShowBigBox(true);\n      },\n      onAddFavorite: function onAddFavorite() {\n        handleAddFavorite(index);\n      },\n      openEditBox: function openEditBox() {\n        setShowEditBox(true);\n        setCurItemIndex(index);\n      }\n    });\n  })), __jsx(Flex, {\n    fontSize: \"0.27rem\",\n    color: \"#fff\",\n    justifyContent: \"\"\n  }, __jsx(Button, (_jsx = {\n    height: \"1.13rem\",\n    width: \"9.6rem\",\n    bg: \"#000\",\n    variant: \"primary\",\n    padding: \"0\"\n  }, _defineProperty(_jsx, \"height\", \"1.13rem\"), _defineProperty(_jsx, \"width\", \"9.6rem\"), _defineProperty(_jsx, \"sx\", {\n    borderRadius: 0,\n    cursor: \"pointer\"\n  }), _defineProperty(_jsx, \"onClick\", function onClick() {\n    Router.back();\n  }), _jsx), \"< RETURN\"), __jsx(Button, (_jsx2 = {\n    height: \"1.13rem\",\n    width: \"9.6rem\",\n    bg: \"#FF8E6C\",\n    variant: \"primary\",\n    padding: \"0\"\n  }, _defineProperty(_jsx2, \"height\", \"1.13rem\"), _defineProperty(_jsx2, \"width\", \"9.6rem\"), _defineProperty(_jsx2, \"sx\", {\n    borderRadius: 0,\n    cursor: \"pointer\"\n  }), _defineProperty(_jsx2, \"onClick\", function onClick() {\n    Router.push(\"/mine\");\n  }), _jsx2), \"COMPLETE\"))), showBigBox ? __jsx(BigBox, {\n    styleDetails: styleDetails,\n    curStyle: styleInitData[curItemIndex],\n    onClose: function onClose() {\n      setShowBigBox(false);\n    }\n  }) : null, showEditBox ? __jsx(EditBox, {\n    styleDetails: styleDetails,\n    curStyle: styleInitData[curItemIndex],\n    confirmMade: handleConfirmMade,\n    onClose: function onClose() {\n      setShowEditBox(false);\n    }\n  }) : null));\n});","map":null,"metadata":{},"sourceType":"module"}